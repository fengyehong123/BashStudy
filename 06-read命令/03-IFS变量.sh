#!/usr/bin/env bash

# ---------------------------------------------------------------------------------------------------
# â¹readå‘½ä»¤è¯»å–çš„å€¼ï¼Œé»˜è®¤æ˜¯ä»¥ç©ºæ ¼åˆ†éš”ã€‚
# å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ç¯å¢ƒå˜é‡IFSï¼ˆå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼ŒInternal Field Separator çš„ç¼©å†™ï¼‰ï¼Œä¿®æ”¹åˆ†éš”æ ‡å¿—ã€‚
# 
# â¹IFSçš„é»˜è®¤å€¼æ˜¯
#            ç©ºæ ¼
#            Tab
#            æ¢è¡Œç¬¦
# é€šå¸¸å–ç©ºæ ¼ä½œä¸ºé»˜è®¤å€¼
# 
# â¹å¦‚æœæŠŠIFSå®šä¹‰æˆå†’å· : æˆ– åˆ†å· ;
# å°±å¯ä»¥è·å–ä»¥è¿™ä¸¤ä¸ªç¬¦å·åˆ†éš”çš„å€¼ï¼Œè¿™å¯¹è¯»å–æ–‡ä»¶å¾ˆæœ‰ç”¨ã€‚
# ---------------------------------------------------------------------------------------------------
cd 06-readå‘½ä»¤ || exit

# å­˜å‚¨å¯†ç çš„æ–‡ä»¶è·¯å¾„
password_file_path=./00-passwd.txt

# â¹æ ¹æ®è¾“å…¥çš„ç”¨æˆ·åç§°ï¼Œé€šè¿‡grepå‘½ä»¤æŸ¥æ‰¾å¯¹åº”çš„ä¿¡æ¯
read -r -p "è¯·è¾“å…¥æƒ³æŸ¥æ‰¾çš„ç”¨æˆ·åç§° > " user_name
file_info="$(grep "^${user_name}:" ${password_file_path})"

# å½“æœç´¢çš„ç”¨æˆ·åå­˜åœ¨çš„æƒ…å†µ
if [ -n "$file_info" ]; then
    # --------------------------------------------------------------------------------------
    # ğŸ”´1. å› ä¸ºè·å–åˆ°çš„è¡Œæ•°æ®æ˜¯ä»¥ : åˆ†éš”çš„ï¼Œæ‰€ä»¥è®¾ç½® IFS=":"
    # ğŸ”´2. read -r user _ uid gid name home shell <<< "$file_info"
    #    å°† grep åˆ°çš„æ•°æ®ç»™readè¯»å–ï¼Œå°†è¯»å–åˆ°çš„æ•°æ®(å·²ç»ç”¨ : åˆ†éš”å®Œæ¯•)ä¾æ¬¡æ”¾åˆ°å¯¹åº”çš„å˜é‡ä¸­
    #    å¦‚æœæœ‰éƒ¨åˆ†å­—æ®µå¹¶æœªä½¿ç”¨ï¼Œéœ€è¦å¿½ç•¥ï¼Œä½¿ç”¨ _
    # ğŸ”´3. IFSçš„èµ‹å€¼å‘½ä»¤å’Œreadå‘½ä»¤å†™åœ¨ä¸€è¡Œï¼Œ
    #    è¿™æ ·çš„è¯ï¼ŒIFSçš„æ”¹å˜ä»…å¯¹åé¢çš„å‘½ä»¤ç”Ÿæ•ˆï¼Œè¯¥å‘½ä»¤æ‰§è¡ŒåIFSä¼šè‡ªåŠ¨æ¢å¤åŸæ¥çš„å€¼ã€‚
    # --------------------------------------------------------------------------------------
    IFS=":" read -r user _ uid gid name home shell <<< "$file_info"

    echo "ç”¨æˆ·å -> $user"
    echo "UID -> $uid"
    echo "GID -> $gid"
    echo "Full Name -> $name"
    echo "å®¶ç›®å½• -> $home"
    echo "shell -> $shell"
else
    echo -e "å½“å‰ç”¨æˆ·ä¸å­˜åœ¨ ==> \e[1;31m $user_name \e[0m"
    exit 1
fi

echo -e "\e[1;31m/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_åˆ†å‰²çº¿_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_\e[0m"

# --------------------------------------------------------------------------------------
# â¹å¦‚æœIFSè®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå°±ç­‰åŒäºå°†æ•´è¡Œè¯»å…¥ä¸€ä¸ªå˜é‡ã€‚
# --------------------------------------------------------------------------------------
while IFS= read -r line; do
    echo "$line"
done < "$password_file_path"