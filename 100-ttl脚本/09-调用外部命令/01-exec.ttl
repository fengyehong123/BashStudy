; 官方文档
; https://teratermproject.github.io/manual/5/ja/macro/command/exec.html

;=====================================================================
; 定义连接服务器的变量参数
HOSTADDR = '172.22.118.28'
USERNAME = 'apluser'
PASSWORD = 'apluser'
;=====================================================================

;=====================================================================
; 开启wsl中的ssh服务
;   1
;       启动中的程序执行完毕之前, 等待
;       程序启动完毕之后, 会把结束code保存到系统变量result中
;   "hide"
;       执行时隐藏窗口
;=====================================================================
exec 'wsl -d Ubuntu_22.04 -- sudo service ssh start' 'hide' 1

if result != -1 then
    ; 格式化连接服务器的命令
    sprintf2 COMMAND "%s:22 /ssh /2 /auth=password /user=%s /passwd=%s" HOSTADDR USERNAME PASSWORD

    ; 连接服务器
    connect COMMAND
else
    messagebox "wsl的ssh启动失败!" '警告'
endif
